import{a as w,U as g}from"./main-c97ccc8c.js";import{S as p}from"./swiper-core-19160206.js";import{A as E}from"./avatars-d33d4d76.js";import"./user_nav-b8e04adf.js";import"https://cdn.jsdelivr.net/npm/aos@2.3.4/+esm";const{VITE_BASEURL:L}={VITE_BASEURL:"https://triangle-golk-json-server.onrender.com",BASE_URL:"/Triangle_Golk/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},d=document.getElementById("nickName"),v=document.querySelector("#nickName"),m=document.querySelector("#edit-btn"),r=document.querySelector("#save-btn"),l=document.querySelector("#now-pwd"),s=document.querySelector("#set-newPwd"),i=document.querySelector("#re-pwd"),y=document.querySelector("#changePwdForm"),S=document.querySelector(".album"),b=document.querySelector("#success-message");let k,P;const a={nickName:"",email:""};async function h(){try{const e=await w.get(`${L}/users`);e.data&&e.data.length>0?(a.nickName=e.data[0].nickName,a.email=e.data[0].email):(a.nickName=v||"",a.email=email||""),document.getElementById("nickName").value=a.nickName,document.getElementById("email").value=a.email,P=await E.getTotal(),k=await g.getUserInfo()}catch(e){console.log(e)}}h();m.addEventListener("click",function(e){e.preventDefault(),d.textContent=v.value,d.removeAttribute("readonly"),m.classList.add("d-none"),r.classList.remove("d-none"),r.classList.remove("btn-secondary"),r.classList.add("btn-outline-secondary")});r.addEventListener("click",function(e){e.preventDefault(),d.setAttribute("readonly",!0),r.classList.add("d-none"),m.classList.remove("d-none")});S.addEventListener("click",e=>{document.querySelectorAll(".avatar-img").forEach(t=>{t.parentElement.classList.remove("albumPic-active"),t.classList.remove("opacity-100")}),e.target.parentElement.classList.add("albumPic-active"),e.target.classList.add("opacity-100"),renderContent(e.target.dataset.id)});b.addEventListener("click",function(){Swal.fire({scrollbarPadding:!1,title:"修改成功",icon:"success",showConfirmButton:!1,timer:1500}),$("#pic-modal").modal("hide")});const f=new p(".swiper-container",{initialSlide:0,navigation:{nextEl:"#changePwd-btn",prevEl:".swiper-prev-btn"},allowTouchMove:!1,spaceBetween:20});document.getElementById("changePwd-btn").addEventListener("click",function(){f.slideNext()});document.getElementById("prev-btn").addEventListener("click",function(){f.slidePrev()});y.addEventListener("submit",e=>{e.preventDefault();const o=l.value.trim(),t=s.value.trim(),n=i.value.trim();l.classList.remove("is-invalid"),s.classList.remove("is-invalid"),i.classList.remove("is-invalid"),o===""||t===""||n===""?(c(l,"欄位不得為空"),c(s,"欄位不得為空"),c(i,"欄位不得為空")):t!==n?Swal.fire({scrollbarPadding:!1,icon:"error",title:"密碼不一致"}):t.length<6||n.length<6?(c(s,"密碼至少需要6個字元"),c(i,"密碼至少需要6個字元"),Swal.fire({scrollbarPadding:!1,icon:"error",title:"密碼至少需要6個字元"})):(N(n),l.classList.add("is-invalid"),s.classList.add("is-invalid"),i.classList.add("is-invalid"),Swal.fire({scrollbarPadding:!1,icon:"success",title:"變更密碼成功"}).then(u=>{(u.isDismissed||u.isConfirmed)&&(location.href="user.html")}))});function c(e,o){const n=e.parentElement.querySelector(".invalid-feedback");n.innerText=o}function N(e){e.parentElement}
