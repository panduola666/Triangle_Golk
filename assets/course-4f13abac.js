import{a as l,S as d}from"./main-4c0e2c7d.js";const{VITE_BASEURL:i}={VITE_BASEURL:"https://triangle-golk-json-server.onrender.com",BASE_URL:"/Triangle_Golk/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},u={async getCourse(a){try{const e=await l.get(`${i}/courses/${a}?_embed=comments&_embed=passes`),{comments:o=[]}=e.data,r=o.reduce((m,s)=>m+=Number(s.score),0)/(o.length||1);return{...e.data,avgScore:Math.floor(r)}}catch(e){if(console.log(e),e.response.status===404){const o=await d.fire({scrollbarPadding:!1,icon:"error",text:"查無此課程"});(o.isConfirmed||o.isDismissed)&&window.history.go(-1)}}},async getAllCourses(){try{let a;const e=new URLSearchParams(window.location.search),o=e.has("platform")?e.getAll("platform"):[],r=e.has("q")?e.get("q"):"";if(window.location.search&&!o.includes("其他平台"))a=await l.get(`${i}/courses${window.location.search}&_embed=comments&_embed=favorites`);else if(window.location.search){o.splice(o.indexOf("其他平台"),1);const c=["六角學院","Udemy","Hahow","Coursera"].filter(t=>!o.includes(t)),n=await l.get(`${i}/courses?_embed=comments&_embed=favorites${r?`&q=${r}`:""}`);a={...n,data:n.data.filter(t=>!c.includes(t.platform))}}else a=await l.get(`${i}/courses?_embed=comments&_embed=favorites`);return a.data.map(s=>{const{comments:c=[]}=s,n=c.reduce((t,f)=>t+=Number(f.score),0)/(c.length||1);return{...s,avgScore:Math.floor(n)}})}catch(a){console.log(a),await d.fire({scrollbarPadding:!1,icon:"error",text:"取得課程失敗"})}}};export{u as C};
